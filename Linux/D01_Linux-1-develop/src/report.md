## Part 1. Установка ОС  

Узнаем весрию установленной системы через команду `cat /etc/issue`.  
![](images/1.png)  

## Part 2. Создание пользователя  

Создаем нового пользователя через команду `sudo useradd -m <username>` и добавляем его в группу adm через команду ` sudo usermod -aG adm <username>`.  
![](images/2.1.png)  

Проверяем вывод команды cat через команду `cat /etc/passwd`.  
![](images/2.2.png)  

## Part 3. Настройка сети ОС  

#### 1. Задаем название машины вида user-1.  
   `-` Смотрим имя пользователя на текущий момент:  
    ![](images/3.1.png)  
    `-` Вводим команду `sudo vim /etc/hostname` для изменения имени пользователя:  
    ![](images/3.3.png)  
    `-` Перезапускаем систему через команду`sudo reboot now`:  
    ![](images/3.4.png)  
    `-` Смотрим внесенные изменения:  
    ![](images/3.5.png)  

#### 2. Устанавливаем временную зону, соответствующую текущему местоположению.  
Используем команды `sudo timedatectl set-timezone` и `timedatectl`.  
    ![](images/3.6.png)  

 #### 3. Выводим названия сетевых интерфейсов.  
 Используем команду `ip a`.  
    ![](images/3.7.png)  
Вывод команды `ip a` начинается с ` 1: lo: `, после чего перечисляется информация о вутреннем ip адресе компьютера. Второй же абзац содержит информацию о внешнем ip адресе компьютера в локальной сети (LAN).  
Интерфейс `lo (local loopback, локальная петля)` - внутренний сетевой интерфейс, который предоставляет доступ к отладке сетевых программ, запущенных на данном устройстве. 

#### 4. Получить от DHCP сервера ip адрес устройства, на котором я работую.  
Использем консольную команду `hostname -I`:  
    ![](images/3.8.png)  
Dynamic Host Configuration Protocol (DHCP) — протокол, который автоматический предоставляет IP адреса и прочие настройки сети (маску сети, шлюз, DNS и т.п) на выделенный диапазон серверов компьютерам и различным устройствам в сети.  

#### 5. Определяем и выводим на экран внешний ip адрес шлюза (ip) и внутренний ip адрес шлюза, он же ip адрес по умолчанию (gw).  
`-` Внешний ip-адрес шлюза (ip) выводим через команду `curl` и сайт 2ip.ru.  
    ![](images/3.9.png)  ## Part 1. Установка ОС  

Узнаем весрию установленной системы через команду `cat /etc/issue`.  
![](images/1.png)  

## Part 4. Обновление ОС  
Обновляем системные пакеты до последней на момент выполнения задания версии.  
Для этого используем команды `sudo apt update` и `sudo apt upgrade`.  
    ![](images/4.1.png)  
    ![](images/4.2.png)  
Псле этого нужно проверить все обновления через повторный запуск команды `sudo apt upgrade`.  
    ![](images/4.3.png)  

## Part 5. Использование команды sudo  
1. Теперь нужно разрешить пользователю, созданному в Part 2, выполнять команду sudo.  
`-` Для этого добавляем пользователя `barnarch_adm` в гурппу `sudo` через команду `sudo usermod -aG sudo barnarch_adm`.  
    ![](images/5.1.png)  
2. Меняем hostname ОС от имени пользователя, созданного в пункте Part 2 (используя sudo).  
`-` Меняем пользователю `barnarch_adm` пароль командой `sudo passwd barnarch_adm`. Далее переходим в его учетку, написав`su barnarch_adm`.    
    ![](images/5.2.png)  
    ![](images/5.3.png)  
`-` Читаем содержимое hostname и меняем его на имя barnarch-2 через команду `sudo hostname barnarch-2`.  
    ![](images/5.4.png)  
`-` Наконец, возвращаемся в учетку barnarch командой `su barnarch`.  
    ![](images/5.5.png)  
Команда sudo — это команда, дословно означающая фразу "выполнить команду Х вместо пользователя Y". Данная утилита дает root привилегии, позволяет выполнять административные операции и дает безграничные возможности (полные права доступа) пользователю.  

## Part 6. Установка и настройка службы времени  
Выводим время, часового пояса, в котором сейчас находимся. Для этого используем команду `sudo timedatectl` для записи данных и команду `timedatectl show` для их отображения.  
    ![](images/6.1.png)  
    ![](images/6.2.png)  

## Part 7. Установка и использование текстовых редакторов  
#### 1. Установить текстовые редакторы VIM (+ любые два по желанию NANO, MCEDIT, JOE и т.д.)  
Устанавливаем текстовый редактор VIM с помощью команды `sudo apt install vim`.  
    ![](images/7.1.png)  

Устанавливаем текстовый редактор NANO с помощью команды `sudo apt install nano`.  
    ![](images/7.2.png)  

Устанавливаем текстовый редактор JOE с помощью команды `sudo apt install joe`.  
    ![](images/7.3.png)  

#### 2. Используя каждый из трех выбранных редакторов, создаем файл `test_X.txt`, где X -- название редактора, в котором создан файл. Напишим в нём свой никнейм, закроем файл с сохранием изменений.  
Редактор VIM:  
`-` С помощью команды `vim test_vim.txt` создадим файл.  
`-` Для выхода из редактора VIM с сохранением содержимого файла нужно нажать кнопку `ESC`, далее написать `:wq!`.  
    ![](images/7.4.png)  
Редактор NANO:  
`-` С помощью команды `nano test_nano.txt` создадим файл.  
`-` Для выхода из редактора NANO с сохранением содержимого файла нужно нажать сочетание клавишь `Ctrl O`, далее `Ctrl X`, и клавиши `Y` и `return`.  
    ![](images/7.5.png)  
Редактор JOE:  
`-` С помощью команды `joe test_joe.txt` создадим файл.  
`-` Для выхода из редактора JOE с сохранением содержимого файла нужно нажать сочетание клавишь `Ctrl K`, далее клавиши `Q` и `Y`.  
    ![](images/7.6.png)  

#### 3. Используя каждый из трех выбранных редакторов, откройте файл на редактирование, отредактируйте файл, заменив никнейм на строку "21 School 21", закройте файл без сохранения изменений.  
Редактор VIM:  
`-` Открываем VIM файл, изменияем его содержимое и выходим из файла. Для выхода из редактора VIM без сохранения содержимого файла нужно нажать кнопку `ESC`, далее написать`:q!`.  
    ![](images/7.7.png)  

Редактор NANO:  
`-` Открываем NANO файл, изменияем его содержимое и выходим из файла. Для выхода из редактора NANO без сохранения содержимого файла нужно нажать сочетание клавишь `Ctrl X`, и клавишу `N`.  
    ![](images/7.8.png)  

Редактор JOE:  
`-` Открываем JOE файл, изменияем его содержимое и выходим из файла. Для выхода из редактора JOE сохранением содержимого файла нужно нажать сочетание клавишь `Ctrl С`, далее клавишy `Y`.  
    ![](images/7.9.png)  

#### 4. Используя каждый из трех выбранных редакторов, отредактируйте файл ещё раз (по аналогии с предыдущим пунктом), а затем освойте функции поиска по содержимому файла (слово) и замены слова на любое другое.  
Редактор VIM:  
`-` Для поиска паттерна в редакторе VIM нужно выйти из режима режактирование через `ESC`, далее напечатать `/` и ввести искомый паттерн.  
    ![](images/7.10.png)  
  
`-` Для замены паттерна в редакторе VIM нужно выйти из режима режактирование через `ESC`, далее напечатать `/`и ввести искомый паттерн, после нажать `return` и клавишу `Y` для сохранения изменнеий.  
    ![](images/7.11.png)  
    ![](images/7.12.png)  

Редактор NANO:  
`-` Для поиска паттерна в редакторе NANO нужно нажать сочетание клавишь `Ctrl W`, далее ввести паттерн, `return`.  
    ![](images/7.13.png)  
  
`-` Для замены паттерна в редакторе NANO нужно нажать сочетание клавишь `Ctrl \`, далее ввести паттерн, `return`, новый паттерн, `return` и клавишу `Y` для сохранения изменнеий.  
    ![](images/7.15.png)  
    ![](images/7.16.png)  

Редактор JOE:  
`-` Для поиска паттерна в редакторе JOE нужно нажать сочетание клавишь `Ctrl K`, далее нажать на клавишу `F`. После написать искомое слово и нажать `return`.  
    ![](images/7.17.png)  

`-` Для замены паттерна в редакторе JOE нужно нажать сочетание клавишь `Ctrl K`, далее нажать клавишу `F`, написать искомое слово, нажать клавишу `R`, ввести новое слово и `return`.  
    ![](images/7.18.png)  
    ![](images/7.19.png)  
    ![](images/7.20.png)  

# Part 8. Установка и базовая настройка сервиса SSHD.  
#### 1. Установить службу SSHd.  
C помощью команды `sudo apt install openssh-server` устанавливаем службу SSHd:  
    ![](images/8.1.png)  
Теперь проверяем, правильно ли установили службу, через команду `sudo service ssh status`:  
    ![](images/8.2.png)  

#### 2. Добавить автостарт службы при загрузке системы.  
Автозапуск ssh службы можно сделать через команду: `sudo systemctl enable ssh.service`, потому что `enable` отвечает за постоянный запуск сервиса после перезагрузки устройства.  
    ![](images/8.3.png)  

#### 3. Перенастроить службу SSHd на порт 2022.  
Чтобы изменить порт, нужно внести изменения в файл, с помощбю команды `sudo nano /etc/ssh/sshd_config`.  
   ![](images/8.4.1.png)  
   
Таким образом, было:  
   ![](images/8.4.2.png)  
Стало:  
   ![](images/8.5.png)  

Проверяем, изменился ли порт, с помощью команды `sudo service ssh status`:  
   ![](images/8.7.png)  

#### 4. Используя команду ps, показать наличие процесса sshd. Для этого к команде нужно подобрать ключи.  
Посмотреть наличие процесса sshd можно с помощью команды `ps -e | grep sshd`. Испозьзуем ключ `-е`.  
   ![](images/8.8.png)  
Расшифровка ключей:  
`-` `ps` показывает список запущенных процессов, которые выполняет позьзователь в окне терминала;  
`-` `ps -a` или `ps -е` отображает все запущенные процессы;  
`-` `ps -d` показывает все процессы, включая фоновые, но кроме процессов сессий;  
`-` `ps -T` отображает процессы, связанные только с данным терминалом;  
`-` `ps -С` показывает процессы по имени команды;  
`-` `ps -G` показывает процессы по ID группы;  
`-` `ps -u` показывает процессы пользователя.  

#### 5. Перезагрузить систему.  
Перезапускаем систему, выполнив команду `sudo systemctl restart sshd`:  
    ![](images/8.6.png)  
или через команду `service ssh restart`:  
    ![](images/8.9.png)  

#####  Команда `netstat` #####  
Команда `netstat` нужна для отображени состояния сетевого интерфейса TCP/IP, выводит на экран список установленных соединений между сокетами нашего компьютера и сокетами удаленных узлов. Сокет - это комбинация IP адреса и намера порта.  Стек протоколов TCP/IP - это набор правил обмена информацией.  

 - Ключи команды `netstat`:  
    `-t`: Отображает только TCP-соединения.  
    `-a`: Отображает все сокеты, включая слушающие и установленные соединения.  
    `-n`: Отображает числовые значения портов и адресов без попыток разрешения имен хостов.  

##### **Расшифровка знанечний столбцов** ##### 
**Proto (Protocol):**  
TCP - это протокол транспортного уровня с установлением соединения гарантированной доставки без потерь данных. Если же пакет не дошел, то он посылается повторно.  
**Recv-Q:**  
Данный столбец отвечает за размер очереди входящих данных для соединения.  
**Send-Q:**  
Данный столбец отвечает за размер очереди исходящих данных для соединения.  
**Local Address:**  
Отображает локальный IP-адрес и порт (IP:port), на котором активно установлено или слушается соединение. 
**Foreign Address:**  
Отображает внешний IP-адрес и порт (IP:port) удаленного хоста, с которым установлено соединение. Звездочки  указывают на незавершенное соединение, например, 0.0.0.0:*.  
**State:**  
Отображает текущее состояние соединения:  
    "LISTEN" (слушается),  
    "ESTABLISHED" (установлено),  
    "TIME_WAIT" (ожидание завершения соединения).  

##### **Значение 0.0.0.0** #####  
Нулевой адрес `0.0.0.0` в команде `netstat` означает все доступные сетевые интерфейсы на устройстве. То есть, устройство слушает на всех доступных сетевых интерфейсах и может принимать соединения от любых клиентов, которые имеют доступ к устройству.  

##### **Вводим команду в терминал:** #####  
   ![](images/8.7.1.png)  
Таким образом, на локальном адресе 0.0.0.0 с портом 2022 наша машина на всех своих внешних ip-адресах слушает 2022 порт, а также на него же готова принимать любые соединения от других устройств.  
Во сторой же строчке написано, что наше устройство на ip-адресе 127.0.0.53 слушет 53 порт. 

# Part 9. Установка и использование утилит top, htop.  

#### 1. Установить и запустить утилиты top и htop.  
Усановка происходит через команды `sudo apt install top` и `sudo apt install htop`:  
    ![](images/9.1.png)  

#### 2. По выводу команды top определить и написать в отчёте:  
Запускаем утилиту top путем ввода в терминал `top`:  
   ![](images/9.2.png)  

Вывод команды `top`показывает:  
    `1.` Uptime -  1 час 16 минут;  
    `2.` Количество авторизованных пользователей - 1;  
    `3.` Общаяя загрузка системы - 0.00, 0.00, 0.00; 
Первый параметр показывает среднюю загрузку сервера за последнюю 1 минуту до ввода команды top.  
Второй параметр - за 5 минут.  
Третий параметр - за 15 минут.  
    `4.` Общее количество процессов - 97;  
В поле Tasks - total указывается общее количество процессов
    `5.` Загрузка cpu - 0.0;  
В поле %Cpu(s) - st — мера загруженности гипервизора;
    `6.` Загрузка памяти - 1971.4 (общий объем оперативной памяти), 1371.2 (объем свободной памяти), 196.8 (объем используемой памяти), 403.4 (объем буфера/кэша);  
    `7.` Pid процесса, занимающего больше всего памяти - 569 root;  
    `8.` Pid процесса, занимающего больше всего процессорного времени - 569 root.  

#### 3. В отчёт вставить скрин с выводом команды htop:  
Запускаем утилиту htop путем ввода в терминал `htop`:  
   ![](images/9.3.png)  

Вывод команды `htop`можно отсортировать несколькими способами:  
    `1.` Отсортировать вывод можно сочетанием клавишей `fn + F6`по параметрам:  
**PID** :   
   ![](images/9.4.png)  
**PERCENT_CPU** :  
   ![](images/9.5.png)  
**PERCENT_MEM** :  
   ![](images/9.6.png)  
**TIME** :    
   ![](images/9.7.png)  
    `2.` Отфильтровать по процессу sshd можно с помощью сочетания клавиш `fn + F4`, а после вводим нужный процесс:  
![](images/9.8.png)  
    `3.` Процесс syslog можно найти через сочетание клавиш `fn + F3` и ввод нужного процесса:  
![](images/9.9.png)  
    `4.` Вывод процессов hostname, clock и uptime можно получить, нажав сочетание клавиш `fn + F2`:  
![](images/9.10.png)  

# Part 10. Использование утилиты fdisk.  

#### 1. Запустить команду fdisk -l.  
Запуск осуществляется через команду `sudo fdisk -l`:  
    ![](images/10.1.png)  
Команда показывает:  
    `1.` Название жесткого диска: /dev/sda (модель VBOX HARDDISK)  
    `2.` Размер жесткого диска: 11.51 GiB  
    `3.` Количество секторов: 24109056  

Размер swap можно узнать через команду `swapon --show `:  
    ![](images/10.2.png)  
В данном сслучае размер swap составляет 2G.  

# Part 11. Использование утилиты df.  

#### 1. Запустить команду df.  
Запуск осуществляется черезе введ в консоль `df`:  
    ![](images/11.1.png)  

Команда выводит:  
    `1.`  Размер раздела: 11758760  
    `2.`  Размер занятого пространства: 5440112
    `3.`  Размер свободного пространства: 5699540
    `4.`  Процент использования: 49%
Единицы измерения в выводе - это килобайт.  

#### 2. Запустить команду df -Th.  
Запуск осуществляется черезе ввод в консоль `df -Th`:  
    ![](images/11.2.png)  

Корневой раздел начинается с символа `/`.  

Команда выводит:  
    `1.`  Размер раздела: 12GB  
    `2.`  Размер занятого пространства: 5.2GB  
    `3.`  Размер свободного пространства: 5.5GB  
    `4.`  Процент использования: 49%  
Тип файловой системы для раздела - это ext4.  

# Part 12. Использование утилиты du.  

#### 1. Запустить команду du.  
Запуск осуществляется через ввод в консоль `du`:  
    ![](images/12.1.png)  

#### 2. Вывести размер папок /home, /var, /var/log (в байтах, в человекочитаемом виде)
Вывод размера папок происходит через команду `du` с флагами `-sh` , а перевод в байты происходит через флаги `-bm` - `sudo du -bmsh /var/log /var /home`  
    ![](images/12.2.png)  
Размер папки /var/log 151 М  
Размер папки /var 746 М  
Размер папки /home 89 K  

#### 3. Вывести размер всего содержимого в /var/log (не общее, а каждого вложенного элемента, используя *)  
Вывод размера всего содержимого происходить через ту же команду и те же флаги, но в конце добавляется символ *, обозначающий всегда все содержимое - `sudo du -sh /var/log/*`  
    ![](images/12.3.png)  
    ![](images/12.4.png)  

# Part 13. Установка и использование утилиты ncdu.  

#### 1. Установить утилиту ncdu.  
Для просмотра размера папок можно дополнительно установить команду `ncdu` - `sudo apt install ncdu`:  
    ![](images/13.1.png)  

#### 2. Вывести размер папок /home, /var, /var/log.
Для вывода размера папок через команду ncdu, нужно в терминале задать команду ncdu + папка:  
    `-` Размер папки /home выводим командой `ncdu /home` составляет 132.0 KiB, apparent size 89.0 KiB:  
    ![](images/13.2.png)  
    `-` Размер папки /var выводим командой `ncdu /var` составляет 901.5 MiB:  
    ![](images/13.3.png)  
    `-` Размер папки /var/log выводим командой `ncdu /var/log` составляет 150.8 M:  
    ![](images/13.4.png)  

# Part 14. Работа с системными журналами.  
#### 1. Откроем для просмотра папку /var/log/dmesg  
Файл dmesg можно открыть через редактор с помощью команды `nano /var/log/dmesg`:  
    ![](images/14.1.png)  

#### 2. Откроем для просмотра папку /var/log/syslog  
Файл dmesg можно открыть через редактор с помощью команды `nano /var/log/syslog`:  
    ![](images/14.2.png)  
    
#### 3. Откроем для просмотра папку /var/log/auth.log  
Файл dmesg можно открыть через редактор с помощью команды `nano /var/log/auth.log`:  
    ![](images/14.3.png)  

`-` Время последней успешной авторизации: Oct 7 13:18:30  
`-` Имя пользователя: barnarch  
`-` Метод входа в систему: Login  

Перезапускаем службу SSHd:  
    ![](images/14.4.png)  

Сообщение о рестарте службы в логах от 0ct 15 14:32:50  
    ![](images/14.5.png)  
 
# Part 15. Использование планировщика заданий CRON.  

### 1. Используя планировщик заданий, запустите команду uptime через каждые 2 минуты.  
Посмотрим существующие у пользователя записи через команду `crontab -l`:  
    ![](images/15.1.png)  
Поскольку записей нет, то создадим их командой `crontab -e`:  
    ![](images/15.2.png)  
    ![](images/15.3.png)  

### 2. Найти в системных журналах строчки (минимум две в заданном временном диапазоне) о выполнении.  
Поиск проводим через функцию grep командой `grep uptime /var/log/syslog`:  
    ![](images/15.4.png)  

### 3. Вывести на экран список текущих заданий для CRON.  
Посмотрим существующие задания через команду `crontab -l`:  
    ![](images/15.5.png)  

### 4. Удалите все задания из планировщика заданий.
Удалить все задания можно командой `crontab -r`:  
    ![](images/15.6.png)  

Повторно посмотрим существующие задания командой `crontab -l`:  
    ![](images/15.7.png)  
